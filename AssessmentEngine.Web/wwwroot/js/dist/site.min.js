const HttpService={post:function(e,t,o){$.ajax({url:e,data:t,success:o,method:"POST",error:function(e){alert("Unexpected error see console for details"),console.error(e)}})},get:function(e,t,o){$.ajax({url:e,success:t,method:"GET",cache:o||!1,error:function(e){alert("Unexpected error see console for details"),console.error(e)}})}},AjaxForm=function(e){this.sel=e.sel,this.$form=$(this.sel),this.action=this.$form.action};AjaxForm.prototype.isValid=function(){return this.$form.validate(),this.$form.valid()},AjaxForm.prototype.serialize=function(){const e={};return this.$form.serializeArray().forEach(t=>e[t.name]=t.value),e},AjaxForm.prototype.submit=function(e,t){this.isValid()&&HttpService.post(this.$form.attr("action"),e,t)};const BoostrapUtility={alertMsg:function(e,t,o){const i=$(e);if(0===i.lengh||!t||!o)return;const n='<div class="alert alert-__type__ alert-dismissible fade show" role="alert">\n            __text__\n            <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n                <span aria-hidden="true">&times;</span>\n            </button>\n        </div>'.replace("__type__",t).replace("__text__",o);i.html(n)}},ManageParticipantView=function(){const e=new Vue({el:"#confirmationModal",data:{modalId:null,action:null,modalTitle:"",modalText:""},methods:{confirmAction:function(){if(this.modalId)switch(this.action){case"toggleLockout":$.post("/Identity/Participant/ToggleLockout?userId="+this.modalId,()=>window.location.reload());break;case"delete":$.post("/Identity/Participant/Delete?userId="+this.modalId,()=>window.location.reload())}},cancelAction:function(){this.modalId=null,this.action=null,this.modalTitle="",this.modalText=""}}}),t=new Vue({el:"#grid",methods:{toggleLockout:function(t){e.action="toggleLockout",e.modalId=t,e.modalTitle="Confirm",e.modalText="Are you sure you want to update this participant?",$("#confirmationModal").modal("show")},deleteParticipant:function(t){e.action="delete",e.modalId=t,e.modalTitle="Confirm Delete",e.modalText="Are you sure you want to delete this participant?",$("#confirmationModal").modal("show")}}});return{confirmationModal:e,grid:t}},TaskVersionView=function(e){$((function(){$("#editTaskVersion").on("submit",i),$("#AssessmentTypeId").on("change",t),t()}));const t=function(){2===parseInt($("#AssessmentTypeId").val())?$("#blockTypeContainer").show():$("#blockTypeContainer").hide()},o=new Vue({el:"#blockGrid",data:{blockVersions:e.blockVersions.map(e=>({isEditing:!1,id:e.id,uid:e.uid,blockTypeId:e.blockTypeId,blockType:e.blockType.name,cognitiveLoad:e.cognitiveLoad,series:e.series}))},methods:{editRow:function(e){this.finishEdit();const t=this.getVersion(e);t&&(t.isEditing=!t.isEditing)},finishEdit:function(){this.blockVersions.forEach(e=>e.isEditing=!1)},toggleCheck:function(e,t){const o=this.getVersion(e);t.target.checked?this.setVersionSeries(o):o.series=null},setVersionSeries:function(e){HttpService.get("/Tasks/TaskVersion/RandomSeries",t=>e.series=t)},getVersion:function(e){return this.blockVersions.find(t=>t.uid===e)}}}),i=function(e){e.preventDefault();const t=new AjaxForm({sel:e.target}),i=t.serialize();i.blockVersions=o.blockVersions.map(e=>({Id:e.id,Uid:e.uid,CognitiveLoad:e.cognitiveLoad,Series:e.series,BlockTypeId:e.blockTypeId})),t.submit(i,e=>{0!==$("#ajaxAlert").length?e.isValid?BoostrapUtility.alertMsg("#ajaxAlert","success","Task version saved successfully!"):BoostrapUtility.alertMsg("#ajaxAlert","danger","Please fix the following errors: "+e.errors.join(", ")):window.location.href="/Tasks/TaskVersion/Edit/"+e.data.taskVersionId})};return{blockGrid:o,submitForm:i}},TaskVersionsView=function(e){const t=new Vue({el:"#confirmationModal",data:{modalId:null,action:null,modalTitle:"",modalText:""},methods:{confirmAction:function(){if(this.modalId)switch(this.action){case"delete":$.post("/Tasks/TaskVersion/Delete/"+this.modalId,()=>{o.deleteVersion(this.modalId),$("#confirmationModal").modal("hide")})}},cancelAction:function(){this.modalId=null,this.action=null,this.modalTitle="",this.modalText=""}}}),o=new Vue({el:"#grid",data:{versions:e},methods:{confirmDelete:function(e){t.modalId=e,t.action="delete",t.modalTitle="Confirm",t.modalText="Are you sure you want to delete this assessment version?",$("#confirmationModal").modal("show")},deleteVersion:function(e){const t=this.versions.findIndex(t=>t.id===e);-1!==t&&this.versions.splice(t,1)}}});return{confirmationModal:t,grid:o}};